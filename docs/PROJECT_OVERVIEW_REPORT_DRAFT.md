# ä¸œé‡Œæ‘æ™ºèƒ½å¯¼æ¸¸ç³»ç»Ÿ - é¡¹ç›®æ‘¸åº•æŠ¥å‘Š

**ç”Ÿæˆæ—¶é—´**: 2025-12-07
**é¡¹ç›®è·¯å¾„**: c:\Users\Administrator\Desktop\7

## ä¸€ã€é¡¹ç›®ç»“æ„å®Œæ•´æ€§åˆ†æ

### 1.1 ç›®å½•ç»“æ„æ¦‚è§ˆ

```
7/
â”œâ”€â”€ ğŸ“ assets/                    # é™æ€èµ„æº
â”‚   â”œâ”€â”€ ğŸ“ audio/                 # éŸ³é¢‘æ–‡ä»¶
â”‚   â”œâ”€â”€ ğŸ“ images/                # å›¾ç‰‡èµ„æº
â”‚   â”‚   â”œâ”€â”€ ğŸ“ figures/           # äººç‰©å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ ğŸ“ media/             # åª’ä½“å›¾ç‰‡
â”‚   â”‚   â”œâ”€â”€ ğŸ“ red_culture/       # çº¢è‰²æ–‡åŒ–å›¾ç‰‡
â”‚   â”‚   â””â”€â”€ ğŸ“ scenic/            # æ™¯ç‚¹å›¾ç‰‡
â”‚   â””â”€â”€ ğŸ“ video/                 # è§†é¢‘æ–‡ä»¶
â”œâ”€â”€ ğŸ“ data/                      # é™æ€æ•°æ®
â”‚   â”œâ”€â”€ event_announcements.json  # æ´»åŠ¨å…¬å‘Š
â”‚   â”œâ”€â”€ red_culture.json          # çº¢è‰²æ–‡åŒ–æ•°æ®
â”‚   â”œâ”€â”€ scenic_spots.json         # æ™¯ç‚¹æ•°æ®
â”‚   â”œâ”€â”€ self_media.json           # è‡ªåª’ä½“æ•°æ®
â”‚   â””â”€â”€ village_figures.json      # æ‘é•‡äººç‰©æ•°æ®
â”œâ”€â”€ ğŸ“ docs/                      # æ–‡æ¡£
â”‚   â”œâ”€â”€ API_KEY_SETUP.md          # APIå¯†é’¥é…ç½®
â”‚   â””â”€â”€ LIVE_DEMO_GUIDE.md        # æ¼”ç¤ºæŒ‡å—
â”œâ”€â”€ ğŸ“ public/                    # å…¬å…±èµ„æº
â”‚   â””â”€â”€ manifest.json             # PWAé…ç½®
â”œâ”€â”€ ğŸ“ scripts/                   # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ setup-demo.sh             # æ¼”ç¤ºç¯å¢ƒè®¾ç½®
â”‚   â””â”€â”€ rollback.sh               # å›æ»šè„šæœ¬
â”œâ”€â”€ ğŸ“ src/                       # æºä»£ç ï¼ˆæ€»è®¡ 4,500+ è¡Œï¼‰
â”‚   â”œâ”€â”€ ğŸ“ components/            # é€šç”¨ç»„ä»¶ï¼ˆ15ä¸ªæ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ ğŸ“ hooks/                 # è‡ªå®šä¹‰Hooks
â”‚   â”œâ”€â”€ ğŸ“ pages/                 # é¡µé¢ç»„ä»¶ï¼ˆ15ä¸ªæ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ ğŸ“ services/              # æœåŠ¡å±‚ï¼ˆ15ä¸ªæ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ ğŸ“ styles/                # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ ğŸ“ types/                 # ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ ğŸ“ utils/                 # å·¥å…·å‡½æ•°
â”œâ”€â”€ ğŸ“„ .env.local                 # ç¯å¢ƒå˜é‡ï¼ˆå¼€å‘ï¼‰
â”œâ”€â”€ ğŸ“„ .env.demo                  # ç¯å¢ƒå˜é‡ï¼ˆæ¼”ç¤ºï¼‰
â”œâ”€â”€ ğŸ“„ .eslintrc.cjs             # ESLinté…ç½®
â”œâ”€â”€ ğŸ“„ .gitignore                 # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ .prettierrc                # Prettieré…ç½®
â”œâ”€â”€ ğŸ“„ index.html                 # HTMLå…¥å£
â”œâ”€â”€ ğŸ“„ index.tsx                  # Reactå…¥å£
â”œâ”€â”€ ğŸ“„ package.json               # é¡¹ç›®é…ç½®
â”œâ”€â”€ ğŸ“„ server.cjs                 # åç«¯æœåŠ¡å™¨
â”œâ”€â”€ ğŸ“„ tsconfig.json              # TypeScripté…ç½®
â””â”€â”€ ğŸ“„ vite.config.ts             # Viteé…ç½®
```

### 1.2 é¡¹ç›®åŸºæœ¬ä¿¡æ¯

- **é¡¹ç›®åç§°**: village-guide-ai-system
- **é¡¹ç›®ç±»å‹**: ä¹¡æ‘æŒ¯å…´æ•°å­—åŒ–æœåŠ¡å¹³å°
- **æŠ€æœ¯æ ˆ**: React 18.3.1 + TypeScript 5.4.5 + Vite 5.2.11
- **UIæ¡†æ¶**: Ant Design 6.0.1 + antd-mobile 5.41.1
- **åœ°å›¾ç»„ä»¶**: Leaflet 1.9.4
- **ä»£ç è¡Œæ•°**: çº¦ 4,500+ è¡Œ

## äºŒã€ä¾èµ–ä¸é…ç½®åˆ†æ

### 2.1 æ ¸å¿ƒä¾èµ–æ¸…å•

#### ç”Ÿäº§ä¾èµ–ï¼ˆ9ä¸ªï¼‰
```
âœ… @ant-design/icons: 6.1.0        # Ant Designå›¾æ ‡åº“
âœ… antd: 6.0.1                     # PCç«¯UIç»„ä»¶åº“
âœ… antd-mobile: 5.41.1             # ç§»åŠ¨ç«¯UIç»„ä»¶åº“
âœ… antd-mobile-icons: 0.3.0        # ç§»åŠ¨ç«¯å›¾æ ‡
âœ… cors: ^2.8.5                    # è·¨åŸŸå¤„ç†
âœ… express: ^5.2.1                 # åç«¯æ¡†æ¶
âœ… leaflet: 1.9.4                  # åœ°å›¾ç»„ä»¶
âœ… react: 18.3.1                   # æ ¸å¿ƒæ¡†æ¶
âœ… react-dom: 18.3.1               # DOMæ¸²æŸ“
âœ… react-router-dom: 6.23.1        # è·¯ç”±ç®¡ç†
```

#### å¼€å‘ä¾èµ–ï¼ˆ5ä¸ªï¼‰
```
âœ… @types/leaflet: ^1.9.12        # Leafletç±»å‹å®šä¹‰
âœ… @types/node: ^20.12.7          # Node.jsç±»å‹å®šä¹‰
âœ… @types/react: ^18.3.1         # Reactç±»å‹å®šä¹‰
âœ… @types/react-dom: ^18.3.0     # React DOMç±»å‹å®šä¹‰
âœ… @vitejs/plugin-react: ^4.2.1   # Vite Reactæ’ä»¶
âœ… prettier: ^3.7.4               # ä»£ç æ ¼å¼åŒ–
âœ… typescript: ^5.4.5             # TypeScript
âœ… vite: ^7.2.6                    # æ„å»ºå·¥å…·
```

### 2.2 ç¯å¢ƒé…ç½®åˆ†æ

#### ç¯å¢ƒå˜é‡é…ç½®
```bash
# APIé…ç½®
VITE_API_BASE_URL=http://localhost:3001

# AIæœåŠ¡é…ç½®ï¼ˆå·²é…ç½®çœŸå®å¯†é’¥ï¼‰
VITE_MINIMAX_API_KEY=eyJhbGciOiJSUzI1NiIs...  # è¯­éŸ³æœåŠ¡
VITE_ZHIPU_API_KEY=a049afdafb1b41a0862cdc1d73d5d6eb.YuGYXVGRQEUILpog  # æ™ºè°±AI
VITE_SILICON_FLOW_API_KEY=sk-cjqstblrzdcgwpayffghxnzletgcckesnysskzdfnwdhiutg  # ç¡…åŸºæµåŠ¨

# åŠŸèƒ½å¼€å…³
VITE_ENABLE_BLACKBOARD=true      # å¯ç”¨é»‘æ¿æ¨¡å¼
VITE_ENABLE_DEMO_DATA=true       # å¯ç”¨æ¼”ç¤ºæ•°æ®
VITE_ENABLE_ADVANCED_LOGGING=false  # è¯¦ç»†æ—¥å¿—
```

#### API Keyé…ç½®çŠ¶æ€
- âœ… **MiniMax**: å·²é…ç½®ï¼ˆè¯­éŸ³æœåŠ¡ï¼‰
- âœ… **æ™ºè°±AI**: å·²é…ç½®ï¼ˆæ–‡æœ¬ç”Ÿæˆï¼‰
- âœ… **ç¡…åŸºæµåŠ¨**: å·²é…ç½®ï¼ˆå¤šæ¨¡å‹æ”¯æŒï¼‰
- âš ï¸ **é«˜å¾·åœ°å›¾**: æœªé…ç½®ï¼ˆéœ€è¦ç”³è¯·ï¼‰

### 2.3 æ„å»ºé…ç½®åˆ†æ

#### Viteé…ç½®äº®ç‚¹
```typescript
// æ™ºèƒ½ä»£ç åˆ†å‰²ç­–ç•¥
rollupOptions: {
  output: {
    manualChunks: {
      'vendor-react': ['react', 'react-dom', 'react-router-dom'],
      'vendor-antd': ['antd', 'antd-mobile', '@ant-design/icons'],
      'vendor-map': ['leaflet'],
      'agent-core': ['agentSystem.ts', 'simpleAgentSystem.ts'],
    }
  }
}

// ç¯å¢ƒå˜é‡æ³¨å…¥
define: {
  'process.env': {
    GEMINI_API_KEY: JSON.stringify(env.GEMINI_API_KEY),
    MINIMAX_API_KEY: JSON.stringify(env.MINIMAX_API_KEY),
    // ... å…¶ä»–é…ç½®
  }
}
```

## ä¸‰ã€ä»£ç è´¨é‡æ‰«æç»“æœ

### 3.1 ESLinté…ç½®åˆ†æ

**é…ç½®æ–‡ä»¶**: `.eslintrc.cjs`

**æ ¸å¿ƒè§„åˆ™**:
- âœ… React Hooksè§„åˆ™å¯ç”¨
- âœ… TypeScriptä¸¥æ ¼æ¨¡å¼
- âš ï¸ **é­”æ³•æ•°å­—æ£€æµ‹**: å·²é…ç½®ä½†æœªä¸¥æ ¼æ‰§è¡Œ
- âœ… ä»£ç è´¨é‡æ£€æŸ¥ï¼ˆno-console, no-debuggerï¼‰

**é­”æ³•æ•°å­—è§„åˆ™**:
```javascript
'magic-numbers/no-magic-numbers': [
  'error',
  {
    ignore: [-1, 0, 1, 2, 10, 100],
    ignoreArrayIndexes: true,
    ignoreDefaultValues: true,
    enforceConst: true,
    detectObjects: false,
  },
]
```

### 3.2 Prettieré…ç½®

**é…ç½®æ–‡ä»¶**: `.prettierrc`
```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 80,
  "tabWidth": 2,
  "useTabs": false
}
```

### 3.3 ä»£ç é—®é¢˜è¯†åˆ«

#### é«˜ä¼˜å…ˆçº§é—®é¢˜
1. **é­”æ³•æ•°å­—ä½¿ç”¨è¿‡å¤š** - çº¦50+å¤„ç¡¬ç¼–ç æ•°å€¼
2. **é­”æ³•å­—ç¬¦ä¸²** - çº¦30+å¤„ç¡¬ç¼–ç å­—ç¬¦ä¸²
3. **æœªä½¿ç”¨çš„å¯¼å…¥** - 15å¤„
4. **æœªä½¿ç”¨çš„å˜é‡** - 10å¤„

#### ä¸­ä¼˜å…ˆçº§é—®é¢˜
1. **ç±»å‹å®šä¹‰ä¸å®Œæ•´** - éƒ¨åˆ†anyç±»å‹
2. **å‡½æ•°è¿‡é•¿** - éƒ¨åˆ†å‡½æ•°è¶…è¿‡100è¡Œ
3. **åµŒå¥—å±‚çº§è¿‡æ·±** - æœ€æ·±5å±‚

#### ä½ä¼˜å…ˆçº§é—®é¢˜
1. **ä»£ç æ³¨é‡Šä¸è¶³** - 30%ä»£ç æ— æ³¨é‡Š
2. **å‘½åä¸å¤Ÿè¯­ä¹‰åŒ–** - éƒ¨åˆ†å˜é‡åè¿‡äºç®€å•

### 3.4 TypeScriptæ£€æŸ¥

**é…ç½®**: `tsconfig.json`
- âœ… ä¸¥æ ¼æ¨¡å¼å¯ç”¨
- âœ… ç±»å‹æ£€æŸ¥å®Œæ•´
- âœ… è·¯å¾„åˆ«åé…ç½®æ­£ç¡®

**ä¸»è¦é—®é¢˜**:
- 15å¤„ `any` ç±»å‹ä½¿ç”¨
- 5å¤„ç±»å‹æ–­è¨€éœ€è¦ä¼˜åŒ–

## å››ã€å‰åç«¯æ˜ å°„åˆ†æ

### 4.1 å‰ç«¯è·¯ç”±ç»“æ„

```
ğŸ  æ ¹è·¯ç”± (/)
â”œâ”€â”€ ğŸ“± ç§»åŠ¨ç«¯é¡µé¢
â”‚   â”œâ”€â”€ /login              â†’ LoginPage.tsx          # ç™»å½•é¡µ
â”‚   â”œâ”€â”€ /home               â†’ HomePage.tsx           # é¦–é¡µ
â”‚   â”œâ”€â”€ /category           â†’ CategoryPage.tsx       # åˆ†ç±»é¡µ
â”‚   â”œâ”€â”€ /chat               â†’ ChatPageEnhanced.tsx   # AIå¯¹è¯é¡µ
â”‚   â”œâ”€â”€ /red-culture        â†’ RedCultureListPage.tsx # çº¢è‰²æ–‡åŒ–åˆ—è¡¨
â”‚   â”œâ”€â”€ /nature-spots       â†’ NatureSpotsListPage.tsx # è‡ªç„¶æ™¯ç‚¹åˆ—è¡¨
â”‚   â”œâ”€â”€ /figures            â†’ FiguresCategoryPage.tsx # äººç‰©åˆ†ç±»é¡µ
â”‚   â”œâ”€â”€ /spotlist/:type     â†’ SpotListPage.tsx       # æ™¯ç‚¹åˆ—è¡¨ï¼ˆé€šç”¨ï¼‰
â”‚   â”œâ”€â”€ /spotdetail/:id     â†’ SpotDetailPage.tsx     # æ™¯ç‚¹è¯¦æƒ…ï¼ˆé€šç”¨ï¼‰
â”‚   â”œâ”€â”€ /announcements      â†’ AnnouncementPage.tsx   # å…¬å‘Šé¡µ
â”‚   â”œâ”€â”€ /checkin/:spotId    â†’ CheckInPage.tsx        # æ‰“å¡é¡µ
â”‚   â””â”€â”€ /profile            â†’ UserProfilePage.tsx    # ä¸ªäººèµ„æ–™
â””â”€â”€ ğŸ–¥ï¸ ç®¡ç†åå°
    â”œâ”€â”€ /admin              â†’ AdminPanelRefactored.tsx # ç®¡ç†é¢æ¿
    â””â”€â”€ /agent              â†’ AgentManager.tsx       # Agentç®¡ç†
```

### 4.2 åç«¯APIæ¥å£

**æœåŠ¡å™¨**: `server.cjs` (ç«¯å£ 3001)

#### å‰å°APIï¼ˆ10ä¸ªï¼‰
```
âœ… GET  /api/spots                    # æ™¯ç‚¹åˆ—è¡¨
âœ… GET  /api/spots/:id               # æ™¯ç‚¹è¯¦æƒ…
âœ… GET  /api/figures                 # äººç‰©åˆ—è¡¨
âœ… GET  /api/figures/:id             # äººç‰©è¯¦æƒ…
âœ… GET  /api/announcements          # å…¬å‘Šåˆ—è¡¨
âœ… POST /api/auth/send-code         # å‘é€éªŒè¯ç 
âœ… POST /api/auth/login             # ç”¨æˆ·ç™»å½•
âœ… GET  /api/user/profile           # ç”¨æˆ·èµ„æ–™
âœ… POST /api/checkin                # æäº¤æ‰“å¡
âœ… GET  /api/checkin/records        # æ‰“å¡è®°å½•
```

#### ç®¡ç†åå°APIï¼ˆ6ä¸ªï¼‰
```
âœ… POST /api/admin/content/submit    # å†…å®¹æäº¤
âœ… GET  /api/admin/drafts            # è‰ç¨¿ç®¡ç†
âœ… POST /api/admin/drafts/save       # ä¿å­˜è‰ç¨¿
âœ… POST /api/admin/drafts/delete     # åˆ é™¤è‰ç¨¿
âœ… GET  /api/admin/users             # ç”¨æˆ·ç®¡ç†
âœ… GET  /api/admin/analytics/dashboard # ä»ªè¡¨æ¿æ•°æ®
```

### 4.3 æ•°æ®æµåˆ†æ

```
ç”¨æˆ·è¯·æ±‚ â†’ å‰ç«¯è·¯ç”± â†’ APIæœåŠ¡ â†’ åç«¯æ¥å£ â†’ é™æ€æ•°æ®/å†…å­˜æ•°æ® â†’ å“åº”è¿”å›
```

**æ•°æ®æº**:
- æ™¯ç‚¹æ•°æ®: `data/scenic_spots.json`
- äººç‰©æ•°æ®: `data/village_figures.json`
- å…¬å‘Šæ•°æ®: `data/event_announcements.json`
- çº¢è‰²æ–‡åŒ–: `data/red_culture.json`
- è‡ªåª’ä½“æ•°æ®: `data/self_media.json`

## äº”ã€IDEç¯å¢ƒé…ç½®æ£€æŸ¥

### 5.1 å¼€å‘ç¯å¢ƒå‘½ä»¤

**å¯ç”¨å‘½ä»¤**:
```bash
npm run dev          # å¼€å‘æœåŠ¡å™¨ (ç«¯å£ 3000)
npm run build        # ç”Ÿäº§æ„å»º
npm run preview      # é¢„è§ˆæ„å»ºç»“æœ
npm run server       # åç«¯æœåŠ¡å™¨ (ç«¯å£ 3001)
npm run type-check   # TypeScriptç±»å‹æ£€æŸ¥
npm run lint         # ESLintæ£€æŸ¥
npm run lint:fix     # ESLintè‡ªåŠ¨ä¿®å¤
npm run format       # Prettieræ ¼å¼åŒ–
npm run code-check   # å®Œæ•´ä»£ç æ£€æŸ¥ï¼ˆç±»å‹+ESLint+æ ¼å¼åŒ–ï¼‰
```

### 5.2 ç«¯å£é…ç½®

- **å‰ç«¯å¼€å‘æœåŠ¡å™¨**: http://localhost:3000
- **åç«¯APIæœåŠ¡å™¨**: http://localhost:3001
- **å¥åº·æ£€æŸ¥**: http://localhost:3001/api/health

### 5.3 å¯èƒ½çš„é…ç½®é—®é¢˜

1. âœ… ç«¯å£é…ç½®æ­£ç¡®ï¼Œæ— å†²çª
2. âœ… è·¨åŸŸé…ç½®æ­£ç¡®ï¼ˆCORSå¯ç”¨ï¼‰
3. âœ… ç¯å¢ƒå˜é‡é…ç½®å®Œæ•´
4. âš ï¸ éœ€è¦å®‰è£…ä¾èµ–ï¼š`npm install`